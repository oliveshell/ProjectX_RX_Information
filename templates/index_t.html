<!doctype html>
<html lang="en" class="no-js">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="theme-color" content="#3e454c">
    
    <title>H48 DPStat - </title>

    <!-- Font awesome -->
    <link rel="stylesheet" href="static/css/font-awesome.min.css">
    <!-- Sandstone Bootstrap CSS -->
    <link rel="stylesheet" href="static/css/bootstrap.min.css">
    <!-- Bootstrap Datatables -->
    <link rel="stylesheet" href="static/css/dataTables.bootstrap.min.css">
    <!-- Bootstrap social button library -->
    <link rel="stylesheet" href="static/css/bootstrap-social.css">
    <!-- Bootstrap select -->
    <link rel="stylesheet" href="static/css/bootstrap-select.css">
    <!-- Bootstrap file input -->
    <link rel="stylesheet" href="static/css/fileinput.min.css">
    <!-- Awesome Bootstrap checkbox -->
    <link rel="stylesheet" href="static/css/awesome-bootstrap-checkbox.css">
    <!-- Admin Stye -->
    <link rel="stylesheet" href="static/css/style.css">
    <!--loading css -->
    <link href="static/css/showLoading.css" rel="stylesheet" media="screen" > 

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
        
<body id= "loading">
    
    <div class="brand clearfix">
        
        <span class="menu-btn"><i class="fa fa-bars"></i></span>
        <ul class="ts-profile-nav">
            <li>
                    <input type="text" id ="ip" class="ts-sidebar-search" placeholder="127.0.0.1">
                </li>
                <li>
                    <input type="text" id = "port" class="ts-sidebar-search" placeholder="18812">
                </li>
            <li class="ts-account">
                <a href="#"><img src="static/img/ts-avatar.jpg" class="ts-avatar hidden-side" alt=""> ALEX <i class="fa fa-angle-down hidden-side"></i></a>
                <ul>
                    <li><a href="/logout"">Logout</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="ts-main-content">
        <nav class="ts-sidebar">
            <ul class="ts-sidebar-menu">
                <li class="ts-label">Search</li>
                <li>
                    <input type="text" class="ts-sidebar-search" placeholder="Search here...">
                </li>
                <li class="ts-label">Main</li>
                
                

            </ul>
        </nav>
        <div class="content-wrapper">
            
            <div class="container-fluid">

                <div class="row">
                    <div class="col-md-12">

                        <h2 class="page-title">DPStat</h2>
                        
                        <!-- <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="panel panel-default">
                                            <div class="panel-body bk-primary text-light">
                                                <div class="stat-panel text-center">
                                                    <div id ="userCount" class="stat-panel-number h1 ">24</div>
                                                    <div class="stat-panel-title text-uppercase">活跃用户</div>
                                                </div>
                                            </div>
                                            <a href="#runtimeReport" class="block-anchor panel-footer">Full Detail <i class="fa fa-arrow-right"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="panel panel-default">
                                            <div class="panel-body bk-success text-light">
                                                <div class="stat-panel text-center">
                                                    <div class="stat-panel-number h1 ">30</div>
                                                    <div class="stat-panel-title text-uppercase">监控服务器</div>
                                                </div>
                                            </div>
                                            <a href="#runtimeReport" class="block-anchor panel-footer text-center">See All &nbsp; <i class="fa fa-arrow-right"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="panel panel-default">
                                            <div class="panel-body bk-info text-light">
                                                <div class="stat-panel text-center">
                                                    <div class="stat-panel-number h1 ">35</div>
                                                    <div class="stat-panel-title text-uppercase">监控渠道</div>
                                                </div>
                                            </div>
                                            <a href="#runtimeReport" class="block-anchor panel-footer text-center">See All &nbsp; <i class="fa fa-arrow-right"></i></a>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="panel panel-default">
                                            <div class="panel-body bk-warning text-light">
                                                <div class="stat-panel text-center">
                                                    <div id= "deviceCount" class="stat-panel-number h1 ">841</div>
                                                    <div class="stat-panel-title text-uppercase">设备类型</div>
                                                </div>
                                            </div>
                                            <a href="#runtimeReport" class="block-anchor panel-footer text-center">See All &nbsp; <i class="fa fa-arrow-right"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <div class = "row ">
                            <div class = "col-md-12">
                                <div class="panel panel-default">
                                   <div class="panel-body">
                                        <div class = 'col-md-12'>  
                                                    <div class = "col-md-1">
                                                        <input type = "text" class = "input-sm form-control " id = "date_1" placeholder="起始日期" >
                                                    </div>
                                                    <div class = "col-md-1" >
                                                        <div >
                                                            <select class = "input-sm form-control" id="date_config">
                                                                <option>查询一天</option>
                                                                <option>两天对比</option>
                                                  
                                                                <option>最近两天</option>
                                                                <option>与上周对比</option>
                                                                
                                                                <option>最近两周</option>
                                                                <option>最近一个月</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class = "col-md-1">
                                                        <input type = "text" class = "input-sm form-control " id = "date_2" placeholder="结束日期" >
                                                    </div>
                                                    <div class = "col-md-2" >
                                                        <div >
                                                            <select class = "input-sm form-control" id="device">
                                                                <option>设备</option><option>设备前20</option>
                                                                <option>设备后20</option>
                                                                <option>设备用户量前30</option>
                                                                <option>设备用户量后30</option>
                                                                <option>某一设备</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class = "col-md-1" style="z-index:100;height:100px">
                                                        <input type = "text" class = "input-sm form-control " data-provide="typeahead" data-items="2" type="text" id = "device_input" 
                                                        style="z-index:-1"
                                                        placeholder="设备型号-选择某一设备填写" >
                                                    </div>
                                                    <div class = "col-md-1" >
                                                        <div >
                                                            <select class = "input-sm form-control" id="dun">
                                                                <option>场景</option><option>主城</option>
                                                                <option>木渎镇</option><option>试炼场</option><option>山海玄境</option><option>天运秘境</option><option>北溟战地</option><option>灵隐寺</option><option>师徒经验</option><option>师徒出师</option><option>结婚</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class = "col-md-1">
                                                    <button type="submit" class="input-sm form-control btn-info" id = "fresh_config" onclick="startConnect()">链接客户端</button>
                                                    </div>
                                        </div>
                                        
                                   </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                            
                                    </div>
                                    <div class="panel-body">
                                        <div class = "col-md-4">
                                            <table id = "message" cellpadding="0" cellspacing="0" border="0" class="display table table-bordered table-striped">
                                                <thead>
                                                    <tr>
                                                        <th>伤害</th>
                                                        <th>技能名称</th>
                                                        <th>伤害来源</th>
                                                    </tr>
                                                </thead>
                                                <tbody id = "message_body" >
                                                    <!-- {% for battle in battle_results %}
                                                            <tr class="gradeA">
                                                                <td>{{battle[4]}}</td>
                                                                <td>{{battle[0]}}</td>
                                                                <td>{{battle[1]}}</td>
                                                                <td>{{battle[2]}}</td>
                                                                <td>{{battle[3]}}</td>
                                                                <td>
                                                    
                                                                </td> 
                                                            </tr>
                                                    {% endfor %} -->
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class ="col-md-4">
                                            <textarea id="dps_output" style="width: 45%; font-size: 15px; margin: 0px; height: 600px;"></textarea>
                                        </div>
                                        <div class = "col-md-4">
                                            <div  id="runtimeReport" style="height:600px;">
                                            
                                        </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                                
                        </div>
                        
                        

                        </div>
                    </div>

            </div>
        </div>
    </div>

    <!-- Loading Scripts -->
    <script src="static/js/jquery.min.js"></script>
    <script src="static/js/bootstrap-select.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/jquery.dataTables.min.js"></script>
    <script src="static/js/dataTables.bootstrap.min.js"></script>
    <script src="static/js/bootstrap-datepicker.js"></script>
    <!-- <script src="static/js/echarts/echarts.js"></script> -->
    <script src="static/js/echarts.js"></script>
    <!-- <script src="static/js/bar.js"></script> -->
    <script src="static/js/fileinput.js"></script>
    <script src="static/js/chartData.js"></script>
    <script src="static/js/Chart.min.js"></script>
    <script src="static/js/main.js"></script>
    <script src="static/js/bootstrap-typeahead.js"></script>
    <script src="static/js/jquery.showLoading.min.js"></script>
    <!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.11.0/css/bootstrap-select.min.css"></script> -->
    <!-- <script src="http://echarts.baidu.com/build/dist/echarts.js"></script> -->
    
    <script>
    $('#date_1').datepicker({
});
    $('#date_2').datepicker({
});




    
    
    

    window.onload = function(){     

        var myEchart = echarts.init(document.getElementById('runtimeReport'));
        
        document.getElementById('dps_output').innerText ='test' ;

        
        // 使用刚指定的配置项和数据显示图表。
        
        myEchart.setOption(option_dun);

        

        myEchart.on('click', function (params) {
    // 警告对话框打印数据项目的名称
    alert(params.value);
});
        //ajax connect the client game
        
        

        
        
        
        
        
        //update interval
        //freshDps();
        
        
    
        
    }
    </script>
    <script>
                //ajax connect the client game
        var startConnect = function(){
            var ip = document.getElementById('ip').value;
            var port  = document.getElementById('port').value;
            var senddata  = {};
            senddata['conn'] = {'ip':ip,'port':port};
            $.ajax({
                type: "GET",
                url: '/conn',
                async: true,
                data: senddata,
                success: function(msg) {
                     
                     console.log(msg);
                     document.getElementById("dps_output").innerText = msg;
                     /*freshDps();
                     freshDps();
                     freshDps();
                     freshDps();*/
                     setInterval(function(){
                            freshDps();
                                },5000);
                              
                },
                error: function (msg) {
                    //alert('获取数据失败');
                    // console.log(msg);
                    // $('#button'+index.toString()).disabled = "false";
                },
                dataType:'text'
            });
        };
        //ajax get the data from backend

        
        var freshDps = function(){
            $.ajax({
                type: "GET",
                url: '/getDps',
                async: true,
                data: {'type':'userdata'},
                success: function(msg) {
                     var data = msg;
                     console.log(data);
                     document.getElementById("dps_output").innerText = data;
                     var table = document.getElementById('message');
                     var row = table.insertRow();
                     row.insertCell().innerHTML = data;       
                },
                error: function (msg) {
                    //alert('获取数据失败');
                    // console.log(msg);
                    // $('#button'+index.toString()).disabled = "false";
                },
                dataType:'text'
            });
        };  
    </script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
    var socket = io.connect('http://' + document.domain + ':' + location.port);
    socket.on('connect', function() {
        socket.emit('my event', {data: 'I\'m connected!'});
    });
    socket.on('my response', function(msg) {
                console.log(msg);
                var table = document.getElementById('message');
                var row = table.insertRow();
                row.insertCell().innerHTML = msg['data']; 
                row.insertCell().innerHTML = msg['data']; 
                row.insertCell().innerHTML = msg['data']; 
                //$('#log').append('<br>Received #' + msg.count + ': ' + msg.data);

            });
</script>
</head>
<body>

